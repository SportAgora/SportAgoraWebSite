<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADM Sport Agora </title>
    <link rel="stylesheet" href="/css/adm/styles.css">
    <link rel="stylesheet" href="/css/adm/sobre_usuarios.css">
    <link rel="icon" href="imagens/SportAgora.png">
    <link rel="icon" href="/imagens/SportAgora.png">
</head>
<body>
    <%- include('../../partials/adm_navbar'); %>
    <%console.log(usuario)%>
    <section class="container-ver-eventos">
            <button class="botao-seta" onclick="window.history.back()">
              <img src="/imagens/left-arrow.png" alt="Seta">
              <span class="ver-eventos">Voltar</span>
            </button>
    </section>
    <section id="logo-area">
            <h1 class="tituloLogo">Sobre Usuario</h1>
        </section>
    <main class="mainsobreuso">
        <section class="infoUSO">
            <p><%=usuario.usu_nome%></p>
            <img src="/<%=usuario.usu_foto%>" alt="Perfil Usuario">
            <h2>Sobre</h2>
            <section class="descricao">
                <h3>Tipo de Usuario</h3>
                <p><%
                switch(usuario.tipo) {
                    case "c":
                        tipoUsuario = "Comum";
                        break;
                    case "o":
                        tipoUsuario = "Organizador";
                        break;
                    case "a":
                        tipoUsuario = "Administrador";
                        break;
                    default:
                        tipoUsuario = "Tipo desconhecido";
                }
                %>
                <%-tipoUsuario%>
                </p>
                
                <h3>Email do Usuario</h3>
                <p><%-usuario.usu_email%></p>
            </section>
        </section>
        <section class="botoesHome">
            <section class="aaaaa">
                <h2>Informações</h2> 
                <!-- <a href="/perfil?id=<%=usuario.usu_id%>" id="aaa"><button class="btnver">Visualizar Perfil</button></a> -->
            </section>

            <section>
                <form action="/adm/usuarios/editar" method="POST" enctype="multipart/form-data">
                    <input type="hidden" name="usu_id" value="<%= usuario.usu_id %>"> 
    
                    <label for="nome">Nome:</label>
                    <input type="text" name="nome" id="nome" value="<%= dadosForm.usu_nome %>">
                    <% if (errorMap.nome) { %><p class="erro-campo"><%= errorMap.nome %></p><% } %>
    
                    <label for="email">Email:</label>
                    <input type="text" name="email" id="email" value="<%= dadosForm.usu_email %>">
                    <% if (errorMap.email) { %><p class="erro-campo"><%= errorMap.email %></p><% } %>
    
                    <label for="senha">Nova Senha (deixe em branco para manter):</label>
                    <input type="password" name="senha" id="senha" placeholder="********" value="<%= dadosForm.senha || '' %>">
                    <% if (errorMap.senha) { %><p class="erro-campo"><%= errorMap.senha %></p><% } %>
    
                    <label for="repsenha">Confirmar Nova Senha:</label>
                    <input type="password" name="repsenha" id="repsenha" placeholder="********" value="<%= dadosForm.repsenha || '' %>">
                    <% if (errorMap.repsenha) { %><p class="erro-campo"><%= errorMap.repsenha %></p><% } %>
                    
                    <label for="tipo">Tipo de Usuário:</label>
                    <select name="tipo" id="tipo">
                        <option value="c" <%= usuario.tipo === 'c' ? 'selected' : '' %>>Comum</option>
                        <option value="o" <%= usuario.tipo === 'o' ? 'selected' : '' %>>Organizador</option>
                        <option value="a" <%= usuario.tipo === 'a' ? 'selected' : '' %>>Administrador</option>
                    </select>
    
                    <label for="foto">Foto:</label>
    
                    <% if (dadosForm.usu_foto) { %>
                        <div class="foto-preview-existente">
                            <img src="/<%= dadosForm.usu_foto %>" alt="Foto do Usuário" id="fotoExistente" style="max-width:200px; display:block; margin-bottom:5px;">
                        </div>
                        <input type="hidden" name="foto_antiga" value="<%= dadosForm.usu_foto %>">
                    <% } %> 
    
                    <div id="novaFotoPreview" style="max-width:300px; margin-bottom: 10px;"></div>
    
                    <input type="file" id="foto" name="foto" accept="image/*">
                    <% if (errorMap.foto) { %><p class="erro-campo"><%= errorMap.foto %></p><% } %>
    
                    <br>
                    <input type="submit" value="Alterar dados">
                </form>
            </section>

            <table class="endereco-tabela">
                <thead>
                    <tr>
                        <th>Ingressos</th>
                        <th>Eventos Postados</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><%= usuario.countIngressos %></td>
                        <td><%= usuario.countEventos %></td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>
    <%- include('../../partials/adm_footer'); %>
</body>
</html>